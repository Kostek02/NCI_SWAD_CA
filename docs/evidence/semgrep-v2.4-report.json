{"version":"1.136.0","results":[{"check_id":"python.flask.security.injection.tainted-sql-string.tainted-sql-string","path":"app/notes/routes.py","start":{"line":245,"col":30,"offset":8196},"end":{"line":245,"col":65,"offset":8231},"extra":{"message":"Detected user input used to manually construct a SQL string. This is usually bad practice because manual construction could accidentally result in a SQL injection. An attacker could use a SQL injection to steal or modify contents of the database. Instead, use a parameterized query which is available by default in most database engines. Alternatively, consider using an object-relational mapper (ORM) such as SQLAlchemy which will protect your queries.","metadata":{"cwe":["CWE-704: Incorrect Type Conversion or Cast"],"owasp":["A01:2017 - Injection","A03:2021 - Injection"],"references":["https://docs.sqlalchemy.org/en/14/core/tutorial.html#using-textual-sql","https://www.tutorialspoint.com/sqlalchemy/sqlalchemy_quick_guide.htm","https://docs.sqlalchemy.org/en/14/core/tutorial.html#using-more-specific-text-with-table-expression-literal-column-and-expression-column"],"category":"security","technology":["sqlalchemy","flask"],"subcategory":["vuln"],"impact":"MEDIUM","likelihood":"MEDIUM","confidence":"MEDIUM","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Improper Validation"],"source":"https://semgrep.dev/r/python.flask.security.injection.tainted-sql-string.tainted-sql-string","shortlink":"https://sg.run/JxZj"},"severity":"ERROR","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}}],"errors":[{"code":3,"level":"warn","type":["PartialParsing",[{"path":"app/templates/429.html","start":{"line":1,"col":1,"offset":0},"end":{"line":2,"col":20,"offset":45}},{"path":"app/templates/429.html","start":{"line":8,"col":1,"offset":0},"end":{"line":8,"col":15,"offset":14}}]],"message":"Syntax error at line app/templates/429.html:1:\n `{% extends \"base.html\" %}\n{% block content %}` was unexpected","path":"app/templates/429.html","spans":[{"file":"app/templates/429.html","start":{"line":1,"col":1,"offset":0},"end":{"line":2,"col":20,"offset":45}},{"file":"app/templates/429.html","start":{"line":8,"col":1,"offset":0},"end":{"line":8,"col":15,"offset":14}}]},{"code":3,"level":"warn","type":["PartialParsing",[{"path":"app/templates/admin/dashboard.html","start":{"line":1,"col":1,"offset":0},"end":{"line":2,"col":20,"offset":45}},{"path":"app/templates/admin/dashboard.html","start":{"line":63,"col":88,"offset":0},"end":{"line":63,"col":109,"offset":21}},{"path":"app/templates/admin/dashboard.html","start":{"line":93,"col":1,"offset":0},"end":{"line":93,"col":15,"offset":14}}]],"message":"Syntax error at line app/templates/admin/dashboard.html:1:\n `{% extends \"base.html\" %}\n{% block content %}` was unexpected","path":"app/templates/admin/dashboard.html","spans":[{"file":"app/templates/admin/dashboard.html","start":{"line":1,"col":1,"offset":0},"end":{"line":2,"col":20,"offset":45}},{"file":"app/templates/admin/dashboard.html","start":{"line":63,"col":88,"offset":0},"end":{"line":63,"col":109,"offset":21}},{"file":"app/templates/admin/dashboard.html","start":{"line":93,"col":1,"offset":0},"end":{"line":93,"col":15,"offset":14}}]},{"code":3,"level":"warn","type":["PartialParsing",[{"path":"app/templates/auth/login.html","start":{"line":1,"col":1,"offset":0},"end":{"line":2,"col":20,"offset":45}},{"path":"app/templates/auth/login.html","start":{"line":52,"col":1,"offset":0},"end":{"line":52,"col":15,"offset":14}}]],"message":"Syntax error at line app/templates/auth/login.html:1:\n `{% extends \"base.html\" %}\n{% block content %}` was unexpected","path":"app/templates/auth/login.html","spans":[{"file":"app/templates/auth/login.html","start":{"line":1,"col":1,"offset":0},"end":{"line":2,"col":20,"offset":45}},{"file":"app/templates/auth/login.html","start":{"line":52,"col":1,"offset":0},"end":{"line":52,"col":15,"offset":14}}]},{"code":3,"level":"warn","type":["PartialParsing",[{"path":"app/templates/auth/register.html","start":{"line":1,"col":1,"offset":0},"end":{"line":2,"col":20,"offset":45}},{"path":"app/templates/auth/register.html","start":{"line":52,"col":1,"offset":0},"end":{"line":52,"col":15,"offset":14}}]],"message":"Syntax error at line app/templates/auth/register.html:1:\n `{% extends \"base.html\" %}\n{% block content %}` was unexpected","path":"app/templates/auth/register.html","spans":[{"file":"app/templates/auth/register.html","start":{"line":1,"col":1,"offset":0},"end":{"line":2,"col":20,"offset":45}},{"file":"app/templates/auth/register.html","start":{"line":52,"col":1,"offset":0},"end":{"line":52,"col":15,"offset":14}}]},{"code":3,"level":"warn","type":["PartialParsing",[{"path":"app/templates/notes/create.html","start":{"line":1,"col":1,"offset":0},"end":{"line":3,"col":20,"offset":113}},{"path":"app/templates/notes/create.html","start":{"line":41,"col":1,"offset":0},"end":{"line":41,"col":15,"offset":14}}]],"message":"Syntax error at line app/templates/notes/create.html:1:\n `{# Create Note Template - v2.1.1: CSRF protection and validation #}\n{% extends \"base.html\" %}\n{% block content %}` was unexpected","path":"app/templates/notes/create.html","spans":[{"file":"app/templates/notes/create.html","start":{"line":1,"col":1,"offset":0},"end":{"line":3,"col":20,"offset":113}},{"file":"app/templates/notes/create.html","start":{"line":41,"col":1,"offset":0},"end":{"line":41,"col":15,"offset":14}}]},{"code":3,"level":"warn","type":["PartialParsing",[{"path":"app/templates/notes/dashboard.html","start":{"line":1,"col":1,"offset":0},"end":{"line":4,"col":20,"offset":162}},{"path":"app/templates/notes/dashboard.html","start":{"line":28,"col":81,"offset":0},"end":{"line":28,"col":103,"offset":22}},{"path":"app/templates/notes/dashboard.html","start":{"line":73,"col":1,"offset":0},"end":{"line":73,"col":15,"offset":14}}]],"message":"Syntax error at line app/templates/notes/dashboard.html:1:\n `{# Notes Dashboard Template - v0.9.1: Functional baseline #}\n{# Displays list of all notes with CRUD action links #}\n{% extends \"base.html\" %}\n{% block content %}` was unexpected","path":"app/templates/notes/dashboard.html","spans":[{"file":"app/templates/notes/dashboard.html","start":{"line":1,"col":1,"offset":0},"end":{"line":4,"col":20,"offset":162}},{"file":"app/templates/notes/dashboard.html","start":{"line":28,"col":81,"offset":0},"end":{"line":28,"col":103,"offset":22}},{"file":"app/templates/notes/dashboard.html","start":{"line":73,"col":1,"offset":0},"end":{"line":73,"col":15,"offset":14}}]},{"code":3,"level":"warn","type":["PartialParsing",[{"path":"app/templates/notes/edit.html","start":{"line":1,"col":1,"offset":0},"end":{"line":3,"col":20,"offset":111}},{"path":"app/templates/notes/edit.html","start":{"line":41,"col":1,"offset":0},"end":{"line":41,"col":15,"offset":14}}]],"message":"Syntax error at line app/templates/notes/edit.html:1:\n `{# Edit Note Template - v2.1.1: CSRF protection and validation #}\n{% extends \"base.html\" %}\n{% block content %}` was unexpected","path":"app/templates/notes/edit.html","spans":[{"file":"app/templates/notes/edit.html","start":{"line":1,"col":1,"offset":0},"end":{"line":3,"col":20,"offset":111}},{"file":"app/templates/notes/edit.html","start":{"line":41,"col":1,"offset":0},"end":{"line":41,"col":15,"offset":14}}]},{"code":3,"level":"warn","type":["PartialParsing",[{"path":"app/templates/notes/view.html","start":{"line":1,"col":1,"offset":0},"end":{"line":5,"col":20,"offset":221}},{"path":"app/templates/notes/view.html","start":{"line":31,"col":1,"offset":0},"end":{"line":31,"col":15,"offset":14}}]],"message":"Syntax error at line app/templates/notes/view.html:1:\n `{# View Note Template - v0.9.1: Functional baseline #}\n{# Read-only view of a single note with action buttons #}\n{# No ownership checks yet - v2.2.1 will add access control #}\n{% extends \"base.html\" %}\n{% block content %}` was unexpected","path":"app/templates/notes/view.html","spans":[{"file":"app/templates/notes/view.html","start":{"line":1,"col":1,"offset":0},"end":{"line":5,"col":20,"offset":221}},{"file":"app/templates/notes/view.html","start":{"line":31,"col":1,"offset":0},"end":{"line":31,"col":15,"offset":14}}]}],"paths":{"scanned":["app/__init__.py","app/admin/__init__.py","app/admin/routes.py","app/audit.py","app/auth/__init__.py","app/auth/forms.py","app/auth/models.py","app/auth/routes.py","app/db.py","app/error_handlers.py","app/helpers.py","app/middleware.py","app/notes/__init__.py","app/notes/forms.py","app/notes/models.py","app/notes/routes.py","app/rbac.py","app/static/css/main.css","app/templates/403.html","app/templates/404.html","app/templates/429.html","app/templates/500.html","app/templates/admin/dashboard.html","app/templates/auth/login.html","app/templates/auth/register.html","app/templates/base.html","app/templates/home.html","app/templates/notes/create.html","app/templates/notes/dashboard.html","app/templates/notes/edit.html","app/templates/notes/view.html"]},"time":{"rules":[],"rules_parse_time":0.7653970718383789,"profiling_times":{"config_time":2.058474063873291,"core_time":1.4168059825897217,"ignores_time":0.0008499622344970703,"total_time":3.476783275604248},"parsing_time":{"total_time":0.0,"per_file_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_files":[]},"scanning_time":{"total_time":0.7655911445617676,"per_file_time":{"mean":0.008321642875671388,"std_dev":0.0003457433393107146},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_files":[]},"matching_time":{"total_time":0.0,"per_file_and_rule_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_rules_on_files":[]},"tainting_time":{"total_time":0.0,"per_def_and_rule_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_rules_on_defs":[]},"fixpoint_timeouts":[],"prefiltering":{"project_level_time":0.0,"file_level_time":0.0,"rules_with_project_prefilters_ratio":0.0,"rules_with_file_prefilters_ratio":0.9889674194104465,"rules_selected_ratio":0.04499224271677297,"rules_matched_ratio":0.04499224271677297},"targets":[],"total_bytes":0,"max_memory_bytes":1134689152},"engine_requested":"OSS","skipped_rules":[]}